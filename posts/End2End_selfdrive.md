---
title: "开发札记--行为克隆模型构建自动驾驶系统"
date: "2025-11-27"
category: "CNN"
description: "偶然间发现了英伟达的End-to-End自动驾驶论文，决定尝试复现其行为克隆模型，并构建一个简单的自动驾驶系统。"
---

## 从Opencv转向现代方法

笔者的2025年主要专注于一个项目--我们称之为`CRAIC城市道路识别小车`，正如其名，这是我所在团队目前主要致力于的一个自动驾驶小车比赛项目。在此之前，团队曾经尝试使用Opencv进行图像处理和简单的路径规划，使用生长算法+Stanley控制器算法实现了一个基础的自动驾驶小车系统。然而，Opencv的方法在复杂环境下表现不佳，难以应对多变的道路和障碍物。特别是在非实验室场地中，光照变化和环境复杂性使得传统图像处理方法难以有效工作，即使在实验室环境下，算法偶发抽风导致的滤波失效也让人实在头痛。在今年比赛落下帷幕后，笔者感觉到传统计算机视觉方法在目前已经达到了一个瓶颈期，难以再有质的飞跃。于是，笔者决定尝试使用深度学习的方法来解决这个问题。

## 对CVPR近年车道线模型的复现

近些年来，CVPR等顶级会议上涌现了大量关于车道线检测和路径规划的深度学习模型，如SCNN、LaneNet等。这些模型通过卷积神经网络（CNN）实现了对车道线的高精度检测和识别，至少在开源数据集上是显著优于传统方法的。同时，车道线模型与我们现有架构是高度适配的，因此我们首先选择了车道线模型。我们团队花费了两个月左右的时间，对近些年CVPR上发表的车道线模型进行了复现和测试。尽管这些模型在开源集上表现突出，但是在我们实际采集的数据集上，效果并不理想。部分模型甚至会出现开源的代码完全无法在其给出的环境下进行运行，需要进行繁杂而低效的对训练代码的修改。最终，我们发现这些车道线模型在实际应用中并没有达到预期的效果，甚至不如我们之前使用的Opencv方法。

## 还是要End-to-End吗......

项目开发到这，对所有之前的工作推倒重来已经成为了一个必然。在这样一个既定的事实下，我们开始思考：如何才能一步到位地构建出一个能够 ***战未来*** 的上位机程序。笔者偶然间发现了英伟达在2016年发表的End-to-End自动驾驶论文（"End to End Learning for Self-Driving Cars"）。这篇论文提出了一种基于行为克隆的自动驾驶方法，通过直接从摄像头图像到车辆控制命令的映射，实现了端到端的自动驾驶。论文中使用了一个简单但有效的CNN架构，能够在模拟环境中实现基本的自动驾驶功能。受到这篇论文的启发，笔者决定尝试复现其行为克隆模型，并基于此构建一个简单的自动驾驶系统。

## 你好，Udacity模拟器

udasity这种在线大学并不出名，笔者也不由得质疑起这种收费微学位项目对于开发者的帮助究竟有多大......但它提供了一个非常实用的自动驾驶模拟器，允许用户采集驾驶数据并训练自己的模型。笔者利用Udacity模拟器采集了大量的驾驶数据，包括摄像头图像和对应的车辆控制命令。随后，笔者基于英伟达的论文架构，使用TensorFlow和Keras搭建了一个简单的CNN模型，并在采集的数据上进行了训练。经过多次调试和优化，最终模型能够在模拟器中实现基本的自动驾驶功能，成功避开障碍物并保持在车道内行驶。

**然而实际上，这中间笔者遇到了非常难绷的环境搭建问题。目前项目所依赖的环境：对于python我们使用3.9+版本，cuda为cuda11.8，cudnn为8.8.1，tensorflow为2.10.0，此环境已经是在权衡配置复杂度和版本新旧之后的最优解，不建议随意进行升级。cudnn在9.0之后的版本使用的是exe文件安装，特别垃圾特别难用，千万不要用。tensorflow2.10.0是最后一个支持cuda11.8的版本，tensorflow2.11.0开始就不支持了，同时tensorflow2.10.0是最后一个支持个人windows的版本，tensorflow2.11.0开始就不支持个人windows了，这个东西只有在tensorflow的英文版本文档里才有，中文文档里找不到，因此也不推荐升级。**

## Future Work？

目前，笔者团队正在构建一个数据收集车，以便在真实环境中采集更多的驾驶数据，在完成初等规模的数据收集后再开始模型正式的构建，训练和优化，但是根据目前的成效来看，这可能是最明智也最正确的一条道路。